---

Техническое задание — Telegram-бот для учёта доставки товара курьерами


---

1. Описание проекта

Система в виде Telegram-бота для автоматизации доставки товаров курьерами в розничные магазины.
Бот обеспечивает:

- [ ] планирование поставок

- [ ] учёт утренней загрузки курьеров

- [ ] фиксацию фактических отгрузок и возвратов

- [ ] учёт оплат (наличные, переводы с фото, долги)

- [ ] контроль долгов и их последующей оплаты

- [ ] подтверждение сдачи наличности и возвратов администратором

- [ ] формирование ежедневных отчётов по каждому курьеру и магазину


Цель: минимизировать ошибки, ускорить процесс, обеспечить прозрачный контроль движения товара и денег.


---

2. Роли пользователей и права доступа

Администратор / кладовщик

Может:

Создавать и редактировать справочники (товары, магазины, курьеры)

Вводить утреннюю загрузку курьеров

Задавать план поставки для магазинов

Верифицировать переводы с фото

Контролировать оплату долгов

Принимать и подтверждать сдачу наличности и возвратов

Смотреть и выгружать отчёты
Не может:

Менять данные визита, закрытого более 24 часов назад (только через отдельный режим редактирования с пометкой)


Курьер

Может:

Просматривать свой план поставки

Фиксировать факт отгрузки и возврата

Фиксировать оплату (наличные, перевод с фото, долг)

Прикреплять фото перевода

Закрывать смену и передавать наличность и возвраты
Не может:

Менять чужие визиты или закрытые визиты

Подтверждать переводы или сдачу



---

3. Справочники (заполняет админ)

Курьеры: ФИО, Telegram ID, статус активности

Магазины: название, адрес

Товары: название, цена, единица измерения



---

4. Основные сценарии работы

Сценарий 1 — Утренняя загрузка (админ)

1. Выбор курьера


2. Ввод количества каждого товара (остаток курьера на день)



Сценарий 2 — План поставки по магазинам (админ)

1. Выбор магазина


2. Ввод планового количества каждого товара



Сценарий 3 — Визит курьера в магазин

1. Выбор магазина → показ плана


2. Ввод фактической отгрузки и возврата


3. Выбор способа оплаты:

Наличные — ввод суммы

Перевод — сумма, ID, фото (статус: "Ожидает верификации")

Отсрочка — сумма, срок оплаты (фиксируется долг)



4. Сохранение визита



Сценарий 4 — Верификация перевода (админ)

1. Просмотр суммы, фото, ID перевода


2. Подтверждение или отклонение


3. Уведомление курьеру



Сценарий 5 — Оплата долгов

1. При оплате долга курьер фиксирует перевод/наличные


2. Админ подтверждает оплату долга


3. Долг получает статус "Оплачен"



Сценарий 6 — Закрытие смены и сдача наличности

Курьер:

1. Нажимает «Закрыть смену»


2. Авторасчёт:

Общая сумма наличных к сдаче

Сумма подтверждённых переводов

Сумма долгов

Возвраты по товарам



3. Передаёт наличность и возвраты админу


4. Статус сдачи: "Ожидает подтверждения"



Админ:

1. Получает уведомление о сдаче


2. Проверяет наличность и возвраты


3. Подтверждает или отклоняет сдачу (с указанием причины)


4. После подтверждения смена закрывается




---

5. Уведомления

Курьер получает:

Новый план поставки

Подтверждение или отклонение перевода

Уведомление о подтверждении/отклонении сдачи смены

Напоминание о долгах магазинов при визите


Админ получает:

Запрос на верификацию перевода

Запрос на подтверждение сдачи наличности

Уведомление об оплате долга



---

6. Формат отчётов

Отчёт курьера (конец дня)

Магазин	Товар	Кол-во отгружено	Возврат	Оплата нал	Оплата перевод	Долг

Магазин 1	Товар А	10	2	5000	0	0
Магазин 1	Товар B	5	0	0	3000	0
Магазин 2	Товар А	8	0	4000	0	2000


Итоги:

Сумма наличных к сдаче: 9000

Сумма подтверждённых переводов: 3000

Сумма долгов: 2000

Возвраты: Товар А — 2 шт.


Отчёт администратора (по курьерам)

Курьер	Наличка к сдаче	Подтв. переводы	Долги	Возвраты	Остаток

Иванов	9000	3000	2000	Товар А — 2	0
Петров	7000	5000	0	—	1 (Товар B)



---

7. Логика статусов

Визит: В процессе / Завершён / Спорный

Оплата: Не оплачено / Ожидает верификации / Оплачено / Отклонено / Долг

Долг: Не оплачен / Оплачен

Сдача наличности: Ожидает подтверждения / Подтверждена / Отклонена

Смена: Открыта / Закрыта



---

8. Структура данных

Курьеры — ID, ФИО, Telegram ID, статус активности
Магазины — ID, название, адрес
Товары — ID, название, цена, ед. изм.
Загрузка курьера — ID, дата, курьер ID, товар ID, количество
План поставки — ID, дата, магазин ID, товар ID, плановое количество
Визиты — ID, дата, курьер ID, магазин ID, статус визита
Фактические отгрузки — ID визита, товар ID, отгружено, возврат
Оплаты — ID визита, тип оплаты, сумма, ID перевода, фото, статус
Долги — магазин ID, сумма, дата, статус оплаты
Сдача смены — ID, дата, курьер ID, сумма наличных, возвраты, статус, примечание


---

9. Flowchart

[Старт]
 ↓
[Авторизация]
 ↓
 ┌─────────────────────────────┬───────────────────────────────┐
 │ Администратор                │ Курьер                        │
 ├─────────────────────────────┼───────────────────────────────┤
 │[Справочники]                 │[Список магазинов с планом]     │
 │[Утренняя загрузка]           │ ↓                             │
 │[План поставок]               │[Выбор магазина]               │
 │[Верификация переводов]       │ ↓                             │
 │[Контроль долгов]              │[Отгрузка и возврат]           │
 │[Отчёты]                      │[Выбор оплаты]                 │
 │                               │  ├ Наличные → сумма           │
 │                               │  ├ Перевод → сумма, ID, фото  │
 │                               │  └ Отсрочка → сумма, срок     │
 │                               │ ↓                             │
 │                               │[Подтверждение визита]         │
 │                               │ ↓                             │
 │                               │[Закрытие смены]               │
 │                               │  ├ Авторасчёт наличных        │
 │                               │  ├ Сумма долгов               │
 │                               │  ├ Возвраты                   │
 │                               │  └ Передача админу            │
 │                               │ ↓                             │
 │[Подтверждение сдачи смены]    │[Ожидание подтверждения]       │
 │                               │ ↓                             │
 │[Смена закрыта]                │[Смена закрыта]                │
 └─────────────────────────────┴───────────────────────────────┘


---

10. Макеты интерфейса (Telegram)

Главное меню администратора:

📦 Справочники  
🚚 Утренняя загрузка  
📝 План поставок  
💳 Верификация переводов (2 новых)  
📊 Отчёты

Главное меню курьера:

📋 Мой план поставки  
🏪 Визит в магазин  
📤 Закрыть смену  
💰 Долги магазинов

Визит курьера (пример):

Магазин: Магазин 1  
План:  
- Товар А: 10 шт  
- Товар B: 5 шт  

Введите фактическое количество отгруженного товара:

(Кнопки)
Отгрузка | Возврат

Выбор оплаты:

Выберите способ оплаты:

(Кнопки)
💵 Наличные | 📲 Перевод | 🕒 Долг

Закрытие смены (пример):

Сумма наличных к сдаче: 9000  
Подтв. переводы: 3000  
Долги: 2000  
Возвраты: Товар А — 2 шт.  

Передайте наличность и возвраты админу и нажмите "Отправить на подтверждение".

(Кнопки)
✅ Отправить на подтверждение


---
